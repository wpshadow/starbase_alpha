// --------------------------------- //
// Project: Starbase_Alpha_dev
// Start: Monday, November 11, 2013
// IDE Version: 11.322


// SETCURRENTDIR("Media") // go to media files



main()


FUNCTION main:
LOCAL id
	sys_init()
	sys_loader()

	// size 0 - n = n + 1
	lvl_generator.size_x = 28
	lvl_generator.size_y = 17

	lvl_generator.rooms_x = 3
	lvl_generator.rooms_y = 3

	lvl_generate_level()
	lvl_generate_wall()
	lvl_generate_light()

	WHILE TRUE

		sys()



		lvl()
		gui()

		SHOWSCREEN
	WEND


ENDFUNCTION



SUB GLB_ON_QUIT:
LOCAL output$[], tmp$, time$[]

	IF sys_settings.fps_logging = 1

		SPLITSTR(PLATFORMINFO$("TIME"), output$[], " ")
		SPLITSTR(output$[1], time$[], ":")

		OPENFILE(0, "logs/fps_" + output$[0] + "_" + time$[0] + "_" + time$[1] + "_" + time$[2] + ".txt", -1)

			IF LEN(fps_log[]) > 0

				FOREACH m IN fps_log[]

					tmp$ = m.date$ + " | fps: " + m.log_fps

					WRITELINE 0, tmp$

				NEXT

			ENDIF

		CLOSEFILE 0

	ENDIF

	// Unload all

	FOREACH i IN image[]
		LOADSPRITE "", i.id$
	NEXT

ENDSUB